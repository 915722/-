# 全国艺术培训机构数据采集系统

![Python Version](https://img.shields.io/badge/python-3.7%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey)

一个基于高德地图API的全国艺术培训机构数据采集工具，支持全国344个城市、50+种艺术专业类别的数据采集，提供友好的图形化界面。

## 📸 项目截图

### 主界面
- 左侧：配置面板（API Key、参数设置、控制按钮）
- 右侧：详细信息（配置详情、实时监控）

### 核心功能
- ✅ 全国34个省级行政区、344个城市数据采集
- ✅ 50+种艺术专业类别、500+个搜索关键词
- ✅ 实时进度监控、彩色日志输出
- ✅ 自动去重、手机号过滤
- ✅ Excel多Sheet导出

---

## 📋 目录

- [功能特性](#功能特性)
- [系统要求](#系统要求)
- [快速开始](#快速开始)
- [详细使用指南](#详细使用指南)
- [API Key获取](#api-key获取)
- [界面说明](#界面说明)
- [数据输出](#数据输出)
- [常见问题](#常见问题)
- [注意事项](#注意事项)

---

## ✨ 功能特性

### 🌏 全国覆盖
- 支持全国34个省级行政区（含直辖市、特别行政区）
- 覆盖344个地级市
- 可自由选择单个或多个城市

### 🎨 专业丰富
**预设50+种艺术专业类别：**
- **乐器类**：钢琴、吉他、古筝、小提琴、架子鼓、萨克斯、二胡、琵琶等
- **舞蹈类**：拉丁舞、民族舞、街舞、芭蕾舞、爵士舞、肚皮舞等
- **美术类**：素描、国画、油画、水彩、漫画、儿童画、速写等
- **书法类**：硬笔书法、软笔书法
- **语言类**：口才、播音主持、朗诵、相声等
- **其他类**：表演、模特、摄影、陶艺、围棋、象棋、跆拳道、武术等

### 📊 智能采集
- 多关键词组合搜索，提高数据覆盖率
- 自动去重，避免重复数据
- 手机号智能过滤（仅保留11位手机号，自动过滤座机）
- 实时保存，断点可恢复

### 🎯 用户友好
- 图形化界面，无需编程基础
- 实时进度显示，采集过程一目了然
- 彩色日志输出，信息清晰易读
- 参数可调，灵活配置
- 配置自动保存，下次使用更便捷

---

## 💻 系统要求

### 环境要求
- **操作系统**: Windows 10/11
- **Python**: 3.7 或更高版本
- **内存**: 建议 4GB 以上
- **网络**: 稳定的互联网连接

### 依赖包
- `tkinter` (Python自带，无需安装)
- `requests` - HTTP请求
- `pandas` - 数据处理
- `openpyxl` - Excel文件操作

---

## 🚀 快速开始

### 1️⃣ 下载项目

#### 方法A：使用Git（推荐）
```bash
git clone https://github.com/你的用户名/你的仓库名.git
cd 你的仓库名
```

#### 方法B：直接下载ZIP
1. 点击页面右上角绿色按钮 `Code`
2. 选择 `Download ZIP`
3. 解压到任意目录

### 2️⃣ 安装依赖

打开命令提示符（CMD）或PowerShell，进入项目目录：

```bash
# 进入项目目录
cd C:\你的路径\项目文件夹

# 安装依赖包
pip install -r requirements.txt
```

**如果安装速度慢，可以使用国内镜像：**
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 3️⃣ 获取API Key

本系统使用高德地图Web服务API，需要申请API Key：

1. 注册账号：访问 [高德开放平台](https://lbs.amap.com/)
2. 登录后进入 [控制台](https://console.amap.com/)
3. 创建应用：
   - 应用名称：随意填写（如：数据采集工具）
   - 应用类型：选择 **Web服务**
4. 添加Key：
   - Key名称：随意填写
   - 服务平台：选择 **Web服务**
5. 复制生成的Key（格式类似：`d127687049259dc6c806bae51df481c1`）

**重要提示：** 高德地图API有免费额度限制，建议购买流量包：
- 价格：30元/万次
- 购买地址：控制台 → 购买服务

### 4️⃣ 启动程序

#### Windows 双击启动（推荐）
```
双击 "启动全国版.bat" 文件
```

#### 命令行启动
```bash
python gui_scraper_china.py
```

---

## 📖 详细使用指南

### 第一步：配置基本参数

启动程序后，在主界面左侧配置：

1. **API Key**（必填）
   - 粘贴你从高德平台获取的API Key
   - 格式：32位字符串

2. **搜索深度**（推荐：20-30页）
   - 每页返回25条数据
   - 数值越大，采集越多，耗时越长
   - 建议：20-30页（500-750条/专业/城市）

3. **请求延迟**（推荐：0.05秒）
   - 每次API请求的间隔时间
   - 太快可能被限流
   - 建议：0.05秒

4. **输出文件**
   - 默认保存到桌面：`采集数据.xlsx`
   - 可点击"浏览"按钮自定义路径

### 第二步：选择城市

切换到 **"城市管理"** 标签页：

#### 方式A：快速选择省份
1. 从下拉框选择省份（如：山东省）
2. 点击 **"快速添加该省所有城市"**
3. 该省所有城市自动添加到右侧列表

#### 方式B：手动选择城市
1. 从下拉框选择省份
2. 在城市列表中勾选想要的城市（支持多选）
3. 点击 **"添加选中城市 →"**

#### 方式C：自定义输入
1. 在输入框输入城市名（如：北京市）
2. 点击 **"添加"** 按钮
3. 提示：必须输入完整名称（带"市"字）

**管理城市：**
- 删除选中：勾选右侧列表中的城市，点击"删除选中"
- 清空全部：点击"清空全部"

### 第三步：选择专业

切换到 **"专业管理"** 标签页：

#### 添加预设专业
1. 在左侧列表勾选专业类别（支持多选）
2. 点击 **"添加选中专业 →"**

**常用组合推荐：**
- **全能套餐**：声乐、钢琴、古筝、舞蹈、美术、书法、口才（7种）
- **乐器套餐**：钢琴、吉他、古筝、小提琴、架子鼓、二胡（6种）
- **舞蹈套餐**：拉丁舞、民族舞、街舞、芭蕾舞、爵士舞（5种）
- **美术套餐**：美术、素描、国画、油画、漫画、儿童画（6种）

#### 查看和编辑关键词
1. 选中一个专业
2. 点击 **"查看关键词"** - 查看该专业的所有搜索关键词
3. 点击 **"编辑关键词"** - 添加/删除/修改关键词

#### 添加自定义专业
1. 输入专业名称（如：书法）
2. 输入关键词，用英文逗号分隔（如：书法培训,书法教学,书法班）
3. 点击 **"添加"**

**管理专业：**
- 删除选中：勾选右侧列表中的专业，点击"删除选中"
- 清空全部：点击"清空全部"

### 第四步：查看配置详情

回到 **"基本设置"** 标签页，点击右侧的 **"📋 配置详情"** 子标签：

可以看到：
- ✅ 已选择的城市列表（最多显示10个，超出显示省略）
- ✅ 已选择的专业列表（显示每个专业的关键词数）
- 📊 预计API消耗次数
- 💰 预估费用

**计算公式：**
```
API调用次数 = 城市数 × 专业数 × 关键词数 × 搜索深度
费用 = API调用次数 ÷ 10,000 × 30元
```

**示例：**
- 山东16市 × 7专业 × 平均8关键词 × 30页 = 26,880次
- 预估费用：约 80.64元

### 第五步：开始采集

1. 确认配置无误后，点击 **"▶️ 开始采集"** 按钮
2. 界面自动切换到 **"▶️ 运行监控"** 子标签
3. 实时查看：
   - **状态文本**：当前正在采集的城市
   - **进度条**：整体完成百分比
   - **统计信息**：有效数据量、过滤数量、已耗时
   - **彩色日志**：
     - 🔵 蓝色 - 标题和分隔线
     - 🟢 绿色 - 成功信息（保存完成、采集完成）
     - 🟡 黄色 - 警告信息（手动停止、过滤数据）
     - 🔴 红色 - 错误信息
     - ⚪ 白色 - 普通信息

**采集过程说明：**
- 系统会逐个城市采集
- 每个城市按专业类别分别采集
- 每个专业按关键词组合搜索
- 数据实时保存，不会丢失
- 可随时点击 **"⏹️ 停止采集"** 中断

### 第六步：完成采集

采集完成后：
1. 进度条显示 **100%**
2. 弹出提示框显示采集结果
3. 日志显示完整统计信息
4. 数据已自动保存到Excel文件

---

## 🔑 API Key获取

### 详细步骤

#### 1. 注册账号
访问：https://lbs.amap.com/
- 点击右上角"注册"
- 填写手机号、密码等信息
- 完成手机验证

#### 2. 实名认证
- 登录后进入控制台
- 完成个人或企业认证（必须完成）

#### 3. 创建应用
- 点击"应用管理" → "我的应用"
- 点击"创建新应用"
- 填写应用信息：
  - **应用名称**：自定义（如：培训机构采集工具）
  - **应用类型**：选择"Web服务"

#### 4. 添加Key
- 在创建的应用下，点击"添加Key"
- 填写Key信息：
  - **Key名称**：自定义（如：数据采集）
  - **服务平台**：选择"Web服务"
- 点击"提交"

#### 5. 获取Key
- 创建成功后，复制生成的Key
- 格式类似：`d127687049259dc6c806bae51df481c1`

### API限额说明

**免费额度：**
- 个人认证：300次/日
- 企业认证：3,000次/日

**收费标准：**
- 流量包：30元/万次
- 按次计费：0.003元/次

**建议：**
- 大量采集建议购买流量包（更划算）
- 30元可调用10,000次，够采集上百个城市

---

## 🖥️ 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│  全国艺术培训机构数据采集系统 - 全国版                    │
├──────────────────┬──────────────────────────────────────┤
│  基本设置  城市管理  专业管理  [运行监控已整合到主页]     │
├──────────────────┴──────────────────────────────────────┤
│                                                           │
│  ┌──────────────┐  ┌─────────────────────────────────┐  │
│  │              │  │  📊 当前配置统计                 │  │
│  │  左侧配置区  │  │  城市: X个 | 专业: X个 | 关键词: X个│
│  │              │  │                                   │  │
│  │ 🔑 API Key   │  │  📍 已加载省份: 34个              │  │
│  │ ⚙️ 采集参数   │  │  🏙️ 可选城市: 344个              │  │
│  │ 💾 输出设置   │  │  🎨 预设专业: 50+个               │  │
│  │ 🎮 控制面板   │  │  🔑 预设关键词: 500+个            │  │
│  │              │  │                                   │  │
│  │  ▶️ 开始采集   │  │  ┌───────────────────────────┐  │  │
│  │  ⏹️ 停止采集   │  │  │ 📋 配置详情  ▶️ 运行监控 │  │  │
│  │  💾 保存配置   │  │  ├───────────────────────────┤  │  │
│  │              │  │  │  已选城市、专业列表         │  │  │
│  └──────────────┘  │  │  API消耗预估、费用预估     │  │  │
│                     │  │  或                         │  │  │
│                     │  │  实时进度、彩色日志         │  │  │
│                     │  └───────────────────────────┘  │  │
│                     │                                   │  │
│                     │  ⚡ 快捷操作                      │  │
│                     │  💡 查看使用指南                  │  │
│                     │  🌟 一键配置山东省                │  │
│                     │  🔥 热门专业推荐                  │  │
│                     └─────────────────────────────────┘  │
│                                                           │
└───────────────────────────────────────────────────────────┘
```

### 标签页说明

#### 1. 基本设置（主页）
- **左侧**：API Key、参数设置、控制按钮
- **右侧**：
  - 📋 配置详情：查看当前选择、预估消耗
  - ▶️ 运行监控：实时进度、彩色日志

#### 2. 城市管理
- **左侧**：省份选择、城市列表
- **右侧**：自定义输入、已选城市列表

#### 3. 专业管理
- **左侧**：预设专业列表
- **右侧**：自定义输入、已选专业列表

---

## 📊 数据输出

### Excel文件结构

```
采集数据.xlsx
├── 汇总（Sheet 1）           - 所有城市的数据汇总
├── 济南（Sheet 2）           - 济南市的数据
├── 青岛（Sheet 3）           - 青岛市的数据
├── 淄博（Sheet 4）           - 淄博市的数据
└── ...                       - 更多城市
```

### 数据字段说明

| 字段名称 | 说明 | 示例 |
|---------|------|------|
| 城市 | 机构所在城市（含区县） | 济南市历下区 |
| 专业 | 专业类别 | 钢琴 |
| 机构名称 | 培训机构名称 | XX艺术培训中心 |
| 手机号 | 11位手机号 | 13800138000 |

### 数据特点

- ✅ **自动去重**：相同机构名称+手机号的记录会被自动去重
- ✅ **手机号过滤**：仅保留11位手机号（1开头），座机自动过滤
- ✅ **实时保存**：每个城市采集完成后立即保存，避免数据丢失
- ✅ **分城市存储**：每个城市单独一个Sheet，方便查看管理

---

## ❓ 常见问题

### Q1: 提示"API调用超限"或"USER_DAILY_QUERY_OVER_LIMIT"？

**原因：** API每日免费额度用完

**解决方案：**
1. **等待次日重置**（免费额度每天0点重置）
2. **购买流量包**（推荐，30元/万次）
   - 进入高德控制台 → 购买服务
   - 选择"Web服务API" → "流量包"
   - 购买后立即生效

### Q2: 采集的数据量较少？

**可能原因及解决方案：**

1. **搜索深度太小**
   - 增加搜索深度（30-50页）

2. **关键词不够**
   - 点击"编辑关键词"添加更多搜索词
   - 每个专业建议8-15个关键词

3. **选择的城市机构较少**
   - 选择更多城市
   - 一线城市数据通常更多

4. **手机号过滤**
   - 系统只保留11位手机号
   - 部分机构没有手机号会被过滤

### Q3: 采集速度很慢？

**这是正常现象：**
- 每次API请求有0.05秒延迟（避免被限流）
- 需要逐页请求数据
- 大量数据需要较长时间

**预估时间：**
- 单城市单专业：1-3分钟
- 单城市全部专业（14个）：10-30分钟
- 全省（16市×14专业）：3-5小时

**建议：**
- 分批采集，不要一次采集太多
- 采集时可以做其他事情，查看进度条了解进度
- 开启采集后可以最小化窗口

### Q4: 程序闪退或报错？

**常见原因及解决：**

1. **Python版本过低**
   - 检查Python版本：`python --version`
   - 需要Python 3.7+

2. **依赖包未安装**
   ```bash
   pip install -r requirements.txt
   ```

3. **API Key错误**
   - 检查Key是否正确复制
   - 确认Key类型为"Web服务"

4. **网络问题**
   - 确保网络连接正常
   - 可以尝试切换网络

### Q5: 如何停止正在进行的采集？

点击 **"⏹️ 停止采集"** 按钮：
- 已采集的数据会保存
- 下次可以继续采集其他城市

### Q6: 配置保存在哪里？

配置自动保存在 `scraper_config.json` 文件中：
- 包含API Key、城市列表、专业列表等
- 下次启动自动加载
- 可以手动删除该文件重新配置

### Q7: 采集的数据重复了怎么办？

系统已自动去重：
- 基于"机构名称+手机号"去重
- 相同机构只保留一条

如果仍有重复：
- 可以在Excel中手动去重
- 数据 → 删除重复值

### Q8: 可以采集其他省份/城市吗？

完全支持：
- 系统已内置全国34省344市
- 在"城市管理"中自由选择
- 支持跨省份多城市同时采集

### Q9: 可以添加自定义专业类别吗？

支持：
1. 切换到"专业管理"
2. 在右侧"自定义输入"区域
3. 输入专业名称和关键词
4. 点击"添加"

### Q10: 数据采集合法吗？

**注意事项：**
- 数据来源于高德地图公开API
- 仅用于学习和研究目的
- 请勿用于商业用途或非法用途
- 遵守《网络安全法》和相关法律法规
- 尊重数据隐私，合理使用

---

## ⚠️ 注意事项

### 使用规范
1. ⚠️ **仅供学习研究使用**，请勿用于商业用途
2. ⚠️ **遵守高德地图API使用协议**
3. ⚠️ **尊重数据隐私**，不得滥用个人信息
4. ⚠️ **合理控制请求频率**，避免对服务器造成压力

### API使用建议
1. ✅ 购买流量包，避免超限
2. ✅ 合理设置请求延迟（建议≥0.05秒）
3. ✅ 分批采集，不要一次采集过多
4. ✅ 定期检查API余额

### 数据使用建议
1. ✅ 数据仅用于市场分析、研究等合法用途
2. ✅ 不得用于骚扰、诈骗等违法行为
3. ✅ 妥善保管数据，防止泄露
4. ✅ 遵守相关法律法规

---

## 📂 项目结构

```
项目根目录/
├── gui_scraper_china.py          # 主程序（GUI界面）
├── shandong_training_scraper.py  # 采集引擎
├── china_cities.json              # 全国城市数据（34省344市）
├── requirements.txt               # Python依赖包列表
├── scraper_config.json            # 配置文件（自动生成）
├── 启动全国版.bat                  # Windows快速启动脚本
└── README.md                      # 本文件
```

---

## 🔄 更新日志

### v1.0 (2025-10-26)
- ✅ 初始版本发布
- ✅ 支持全国344个城市
- ✅ 预设50+种艺术专业
- ✅ 图形化界面
- ✅ 实时进度监控
- ✅ 彩色日志输出
- ✅ 自动去重和数据过滤
- ✅ Excel多Sheet导出

---

## 📄 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

---

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

## 📧 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 提交 Issue
- Pull Request

---

## ⭐ Star

如果这个项目对你有帮助，请给一个 Star ⭐ 支持一下！

---

**最后更新：** 2025-10-26  
**版本：** v1.0
